/* DynamicForms by danny78 JSLibs - MIT License */
Document.addEventListener("DOMContentLoaded",function(){let e={pt:{required:"Este campo \xe9 obrigat\xf3rio.",email:"E-mail inv\xe1lido.",min:"M\xednimo de {0} caracteres.",max:"M\xe1ximo de {0} caracteres.",number:"Somente n\xfameros s\xe3o permitidos.",match:"Os campos n\xe3o coincidem.",password:"A senha deve conter pelo menos 8 caracteres, uma mai\xfascula, uma min\xfascula e um n\xfamero.",date:"Data inv\xe1lida. Use o formato AAAA-MM-DD.",url:"URL inv\xe1lida.",zip:"C\xf3digo postal inv\xe1lido.",file:{required:"Selecione um arquivo.",size:"Tamanho m\xe1ximo: {0}KB",type:"Tipo de arquivo n\xe3o permitido."},regex:"Formato inv\xe1lido.",unique:"Valor j\xe1 est\xe1 em uso."},en:{required:"This field is required.",email:"Invalid email address.",min:"Minimum {0} characters.",max:"Maximum {0} characters.",number:"Only numbers are allowed.",match:"Fields do not match.",password:"Password must contain at least 8 characters, one uppercase, one lowercase and one number.",date:"Invalid date. Use YYYY-MM-DD format.",url:"Invalid URL.",zip:"Invalid ZIP code.",file:{required:"Please select a file.",size:"Maximum size: {0}KB",type:"File type not allowed."},regex:"Invalid format.",unique:"Value is already in use."},es:{required:"Este campo es obligatorio.",email:"Correo electr\xf3nico inv\xe1lido.",min:"M\xednimo {0} caracteres.",max:"M\xe1ximo {0} caracteres.",number:"Solo se permiten n\xfameros.",match:"Los campos no coinciden.",password:"La contrase\xf1a debe contener al menos 8 caracteres, una may\xfascula, una min\xfascula y un n\xfamero.",date:"Fecha inv\xe1lida. Use el formato AAAA-MM-DD.",url:"URL inv\xe1lida.",zip:"C\xf3digo postal inv\xe1lido.",file:{required:"Seleccione un archivo.",size:"Tama\xf1o m\xe1ximo: {0}KB",type:"Tipo de archivo no permitido."},regex:"Formato inv\xe1lido.",unique:"El valor ya est\xe1 en uso."}},a={framework:"default",lang:document.documentElement.lang||"pt",classes:{default:{error:"input-error",success:"input-success",errorMessage:"error-message"},bootstrap:{error:"is-invalid",success:"is-valid",errorMessage:"invalid-feedback"},tailwind:{error:"border-red-500",success:"border-green-500",errorMessage:"text-red-500 text-sm mt-1"}}},r=document.querySelectorAll("form[data-validate]");async function t(e,a){let r=!0,t=e.querySelectorAll("[data-rule]");for(let i of t)await s(i,e,a)||(r=!1);return r?e.dispatchEvent(new CustomEvent("validation:valid")):e.dispatchEvent(new CustomEvent("validation:invalid")),r}async function s(e,a,r){let{error:t,success:s,errorMessage:o}=r.classes[r.framework],l=e.dataset.rule.split("|"),n=e.value.trim(),d=e.nextElementSibling,c=!0,m="";for(let u of l){let[p,v]=u.split(":"),f=i(p,v,r.lang);switch(p){case"required":n||(m=f,c=!1);break;case"email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||(m=f,c=!1);break;case"min":n.length<parseInt(v)&&(m=f.replace("{0}",v),c=!1);break;case"max":n.length>parseInt(v)&&(m=f.replace("{0}",v),c=!1);break;case"number":/^\d+$/.test(n)||(m=f,c=!1);break;case"match":let g=a.querySelector(`[name="${v}"]`);g&&g.value!==n&&(m=f,c=!1);break;case"password":/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}/.test(n)||(m=f,c=!1);break;case"date":/^\d{4}-\d{2}-\d{2}$/.test(n)||(m=f,c=!1);break;case"url":/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(n)||(m=f,c=!1);break;case"zip":/^\d{5}-?\d{3}$/.test(n)||(m=f,c=!1);break;case"file":let b=e.files[0],y=1024*v,h=e.dataset.fileTypes?e.dataset.fileTypes.split(","):["image/jpeg","image/png","application/pdf"];b?b.size>y?(m=f.size.replace("{0}",v),c=!1):h.includes(b.type)||(m=f.type,c=!1):(m=f.required,c=!1);break;case"regex":RegExp(v).test(n)||(m=f,c=!1);break;case"unique":let k=v;try{await fetch(`${k}?value=${n}`).then(e=>e.json())||(m=f,c=!1)}catch(w){console.error("Validation error:",w),m="Erro na valida\xe7\xe3o.",c=!1}}if(!c)break}return c?(d.textContent="",d.style.display="none",e.classList.remove(t),e.classList.add(s)):(d.textContent=m,d.style.display="block",d.className=o,e.classList.add(t),e.classList.remove(s)),c}function i(a,r,t){let s=e[t]||e.pt;return"file"===a?s.file:s[a]||`Validation failed for rule: ${a}`}r.forEach(e=>{let r={...a,framework:e.dataset.framework||a.framework,lang:e.dataset.lang||a.lang},{error:i,success:o,errorMessage:l}=r.classes[r.framework];!function e(a){a.querySelectorAll("[data-mask]").forEach(e=>{let a=e.dataset.mask;e.addEventListener("input",e=>{let r=e.target.value.replace(/\D/g,"");"zip"===a?r=r.replace(/(\d{5})(\d{3})/,"$1-$2"):"phone"===a?r=r.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3"):"date"===a&&(r=r.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),e.target.value=r})})}(e),e.addEventListener("submit",async function(a){await t(e,r)||a.preventDefault()}),e.addEventListener("reset",()=>{!function e(a,r){let{error:t,success:s,errorMessage:i}=r.classes[r.framework];a.querySelectorAll(`.${t}, .${s}`).forEach(e=>{e.classList.remove(t,s)}),a.querySelectorAll(`.${i}`).forEach(e=>{e.textContent="",e.style.display="none"}),a.dispatchEvent(new CustomEvent("validation:reset"))}(e,r)});e.querySelectorAll("[data-rule]").forEach(a=>{a.addEventListener("blur",()=>s(a,e,r)),a.addEventListener("input",()=>{a.classList.contains(i)&&s(a,e,r)})})})});
