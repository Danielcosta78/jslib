/* ChartLib by danny78 JSLib - MIT License */
class ChartLib{constructor(t,i={}){if(this.canvas=document.getElementById(t),!this.canvas)throw Error("Canvas element not found");this.ctx=this.canvas.getContext("2d"),this.options={responsive:!0,maintainAspectRatio:!0,backgroundColor:"#f9f9f9",title:{text:"",font:"16px Arial",color:"#333"},legend:{display:!0,position:"top"},...i},this.data=[],this.chartType="bar",this.colors=["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7"],this.options.responsive&&(this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas()),this.resizeObserver.observe(this.canvas.parentElement),window.addEventListener("resize",()=>this.resizeCanvas()))}resizeCanvas(){if(this.options.maintainAspectRatio){let t=this.canvas.width/this.canvas.height,i=this.canvas.parentElement;this.canvas.width=i.clientWidth,this.canvas.height=i.clientWidth/t}else{let e=this.canvas.parentElement;this.canvas.width=e.clientWidth,this.canvas.height=e.clientHeight}this.draw()}setData(t){return this.data=t,this}setType(t){let i=["bar","line","pie","doughnut","radar"];if(!i.includes(t))throw Error(`Invalid chart type. Valid types are: ${i.join(", ")}`);return this.chartType=t,this}setOptions(t){return this.options={...this.options,...t},this}draw(){switch(this.clearCanvas(),this.drawBackground(),this.drawTitle(),this.chartType){case"bar":this.drawBarChart();break;case"line":this.drawLineChart();break;case"pie":this.drawPieChart();break;case"doughnut":this.drawDoughnutChart();break;case"radar":this.drawRadarChart()}this.options.legend.display&&this.drawLegend()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawBackground(){this.ctx.fillStyle=this.options.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}drawTitle(){this.options.title.text&&(this.ctx.font=this.options.title.font,this.ctx.fillStyle=this.options.title.color,this.ctx.textAlign="center",this.ctx.fillText(this.options.title.text,this.canvas.width/2,30))}drawBarChart(){let t=this.canvas.width,i=this.canvas.height-60,e=t/this.data.length,s=Math.max(...this.data.map(t=>t.value));this.drawGridLines(s,i),this.data.forEach((t,a)=>{let h=t.value/s*i,l=a*e+.1*e,n=i-h+40;this.ctx.fillStyle=t.color||this.colors[a%this.colors.length],this.ctx.fillRect(l,n,.8*e,h),this.options.showValues&&(this.ctx.fillStyle="#333",this.ctx.textAlign="center",this.ctx.fillText(t.value,l+.4*e,n-5)),t.label&&(this.ctx.fillStyle="#666",this.ctx.textAlign="center",this.ctx.fillText(t.label,l+.4*e,i+50))})}drawLineChart(){let t=this.canvas.width,i=this.canvas.height-60,e=t/(this.data.length-1),s=Math.max(...this.data.map(t=>t.value));this.drawGridLines(s,i),this.ctx.beginPath(),this.data.forEach((t,a)=>{let h=a*e,l=i-t.value/s*i+40;0===a?this.ctx.moveTo(h,l):this.ctx.lineTo(h,l)}),this.ctx.strokeStyle=this.options.lineColor||"#4e79a7",this.ctx.lineWidth=3,this.ctx.stroke(),this.data.forEach((t,a)=>{let h=a*e,l=i-t.value/s*i+40;this.ctx.beginPath(),this.ctx.arc(h,l,5,0,2*Math.PI),this.ctx.fillStyle=t.color||this.colors[a%this.colors.length],this.ctx.fill(),this.options.showValues&&(this.ctx.fillStyle="#333",this.ctx.textAlign="center",this.ctx.fillText(t.value,h,l-10)),t.label&&(this.ctx.fillStyle="#666",this.ctx.textAlign="center",this.ctx.fillText(t.label,h,i+50))})}drawPieChart(){let t=this.canvas.width/2,i=this.canvas.height/2,e=.7*Math.min(t,i),s=this.data.reduce((t,i)=>t+i.value,0),a=0;this.data.forEach((h,l)=>{let n=h.value/s*2*Math.PI,c=a+n/2;if(this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.arc(t,i,e,a,a+n),this.ctx.closePath(),this.ctx.fillStyle=h.color||this.colors[l%this.colors.length],this.ctx.fill(),this.options.showLabels){let r=.7*e;this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(`${h.label||""} ${Math.round(h.value/s*100)}%`,t+Math.cos(c)*r,i+Math.sin(c)*r)}a+=n})}drawDoughnutChart(){this.drawPieChart();let t=this.canvas.width/2,i=this.canvas.height/2;this.ctx.beginPath(),this.ctx.arc(t,i,.4*Math.min(t,i),0,2*Math.PI),this.ctx.fillStyle="#fff",this.ctx.fill()}drawRadarChart(){let t=this.canvas.width/2,i=this.canvas.height/2,e=.7*Math.min(t,i),s=Math.max(...this.data.map(t=>t.value)),a=2*Math.PI/this.data.length;for(let h=e;h>0;h-=e/5)this.ctx.beginPath(),this.ctx.arc(t,i,h,0,2*Math.PI),this.ctx.strokeStyle="#eee",this.ctx.stroke();this.data.forEach((s,h)=>{let l=h*a;this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.lineTo(t+Math.sin(l)*e,i-Math.cos(l)*e),this.ctx.strokeStyle="#eee",this.ctx.stroke()}),this.ctx.beginPath(),this.data.forEach((h,l)=>{let n=l*a,c=h.value/s*e,r=t+Math.sin(n)*c,o=i-Math.cos(n)*c;0===l?this.ctx.moveTo(r,o):this.ctx.lineTo(r,o)}),this.ctx.closePath(),this.ctx.fillStyle="rgba(78, 121, 167, 0.5)",this.ctx.strokeStyle="#4e79a7",this.ctx.lineWidth=2,this.ctx.fill(),this.ctx.stroke(),this.data.forEach((s,h)=>{let l=h*a;this.ctx.fillStyle="#333",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(s.label||`Item ${h+1}`,t+Math.sin(l)*(e+20),i-Math.cos(l)*(e+20))})}drawGridLines(t,i){let e=t/5,s=i/5;this.ctx.strokeStyle="#eee",this.ctx.lineWidth=1,this.ctx.textAlign="right",this.ctx.textBaseline="middle",this.ctx.fillStyle="#666";for(let a=0;a<=5;a++){let h=i-a*s+40;this.ctx.beginPath(),this.ctx.moveTo(0,h),this.ctx.lineTo(this.canvas.width,h),this.ctx.stroke(),this.ctx.fillText(Math.round(e*a).toString(),40,h)}}drawLegend(){let t="left"===this.options.legend.position?20:"right"===this.options.legend.position?this.canvas.width-120:this.canvas.width/2-60,i="top"===this.options.legend.position?50:"bottom"===this.options.legend.position?this.canvas.height-30-20*this.data.length:this.canvas.height/2-20*this.data.length/2;this.data.forEach((e,s)=>{this.ctx.fillStyle=e.color||this.colors[s%this.colors.length],this.ctx.fillRect(t,i+20*s,15,15),this.ctx.fillStyle="#333",this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.fillText(e.label||`Series ${s+1}`,t+20,i+20*s)})}}function drawBarChart(t,i,e={}){let s=new ChartLib(t,e);return s.setData(i.map(t=>"number"==typeof t?{value:t}:t)),s.setType("bar"),s.draw(),s}function drawLineChart(t,i,e={}){let s=new ChartLib(t,e);return s.setData(i.map(t=>"number"==typeof t?{value:t}:t)),s.setType("line"),s.draw(),s}function drawPieChart(t,i,e={}){let s=new ChartLib(t,e);return s.setData(i.map(t=>"number"==typeof t?{value:t}:t)),s.setType("pie"),s.draw(),s}function drawDoughnutChart(t,i,e={}){let s=new ChartLib(t,e);return s.setData(i.map(t=>"number"==typeof t?{value:t}:t)),s.setType("doughnut"),s.draw(),s}function drawRadarChart(t,i,e={}){let s=new ChartLib(t,e);return s.setData(i.map(t=>"number"==typeof t?{value:t}:t)),s.setType("radar"),s.draw(),s}
