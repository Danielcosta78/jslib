/* 
 * ChartLib by danny78
 * A comprehensive and customizable charting library
 * Version 1.8.5
 * MIT License
 */
class ChartLib{constructor(t,i={}){if(this.canvas=document.getElementById(t),!this.canvas)throw Error("Canvas element not found");this.ctx=this.canvas.getContext("2d"),this.initializeOptions(i),this.data=[],this.chartType="bar",this.animationFrame=null,this.isAnimating=!1,this.setupEventListeners()}initializeOptions(t){this.options={responsive:!0,maintainAspectRatio:!0,backgroundColor:"#ffffff",chartArea:{padding:{top:20,right:20,bottom:40,left:50},backgroundColor:"transparent",borderColor:"#eaeaea",borderWidth:1},title:{display:!0,text:"",font:"bold 18px Arial",color:"#333333",padding:15,align:"center"},legend:{display:!0,position:"top",align:"center",labels:{font:"12px Arial",color:"#666666",padding:10,boxWidth:15,usePointStyle:!1}},animation:{enabled:!0,duration:1e3,easing:"easeOutQuart"},scales:{x:{display:!0,grid:{display:!0,color:"#f0f0f0",borderDash:[],lineWidth:1},ticks:{font:"12px Arial",color:"#666666",padding:5,maxRotation:45},title:{display:!1,text:"",font:"14px Arial",color:"#333333"}},y:{display:!0,grid:{display:!0,color:"#f0f0f0",borderDash:[],lineWidth:1},ticks:{font:"12px Arial",color:"#666666",padding:5,beginAtZero:!0,callback:t=>t},title:{display:!1,text:"",font:"14px Arial",color:"#333333"}}},tooltip:{enabled:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFont:"bold 12px Arial",titleColor:"#ffffff",bodyFont:"12px Arial",bodyColor:"#ffffff",padding:8,borderRadius:4,displayColors:!0},dataLabels:{display:!1,color:"#333333",font:"12px Arial",padding:4,formatter:t=>t},colors:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#6b9ac4","#d37e2a"],bar:{borderWidth:1,borderRadius:0,borderSkipped:!0,maxBarThickness:100,columnSpacing:.1},line:{tension:.4,fill:!1,pointRadius:4,pointHoverRadius:6,pointStyle:"circle",pointBorderWidth:2,showLine:!0},pie:{cutoutPercentage:0,rotation:0,circumference:360,borderWidth:2,hoverOffset:8},doughnut:{cutoutPercentage:50,rotation:0,circumference:360,borderWidth:2,hoverOffset:8},radar:{angleLines:{display:!0,color:"#e0e0e0",lineWidth:1},pointLabels:{font:"12px Arial",color:"#666666"},polygonStyle:{backgroundColor:"rgba(78, 121, 167, 0.2)",borderColor:"#4e79a7",borderWidth:1}}},this.deepMerge(this.options,t)}deepMerge(t,i){for(let e in i)i.hasOwnProperty(e)&&(i[e]instanceof Object&&!Array.isArray(i[e])?(t[e]||(t[e]={}),this.deepMerge(t[e],i[e])):t[e]=i[e]);return t}setupEventListeners(){if(this.options.responsive&&(this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas()),this.resizeObserver.observe(this.canvas.parentElement),window.addEventListener("resize",()=>this.resizeCanvas())),this.options.tooltip.enabled){let t={element:document.createElement("div"),visible:!1};t.element.style.cssText=`
                position: absolute;
                display: none;
                background: ${this.options.tooltip.backgroundColor};
                padding: ${this.options.tooltip.padding}px;
                border-radius: ${this.options.tooltip.borderRadius}px;
                pointer-events: none;
                z-index: 1000;
            `,document.body.appendChild(t.element),this.canvas.addEventListener("mousemove",i=>this.handleMouseMove(i,t)),this.canvas.addEventListener("mouseout",()=>this.handleMouseOut(t))}}handleMouseMove(t,i){let e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,a=t.clientY-e.top,o=this.findDataPoint(s,a);o?this.showTooltip(o,t.pageX,t.pageY,i):this.hideTooltip(i)}handleMouseOut(t){this.hideTooltip(t)}findDataPoint(t,i){switch(this.chartType){case"bar":return this.findBarDataPoint(t,i);case"line":return this.findLineDataPoint(t,i);case"pie":case"doughnut":return this.findPieDataPoint(t,i);case"radar":return this.findRadarDataPoint(t,i);default:return null}}showTooltip(t,i,e,s){let a=this.formatTooltipContent(t);s.element.innerHTML=a,s.element.style.display="block";let o=s.element.offsetWidth,h=s.element.offsetHeight,n=window.innerWidth,r=window.innerHeight,l=i+10,c=e+10;l+o>n&&(l=i-o-10),c+h>r&&(c=e-h-10),s.element.style.left=`${l}px`,s.element.style.top=`${c}px`}hideTooltip(t){t.element.style.display="none"}formatTooltipContent(t){let{label:i,value:e,color:s}=t;return`
            <div style="font-family: ${this.options.tooltip.titleFont}; color: ${this.options.tooltip.titleColor};">
                ${i}
            </div>
            <div style="font-family: ${this.options.tooltip.bodyFont}; color: ${this.options.tooltip.bodyColor};">
                ${this.options.tooltip.displayColors?`<span style="display: inline-block; width: 10px; height: 10px; background: ${s}; margin-right: 5px;"></span>`:""}
                ${this.options.dataLabels.formatter(e)}
            </div>
        `}resizeCanvas(){let t=this.canvas.parentElement,i=window.getComputedStyle(t),e=parseInt(i.width,10),s=parseInt(i.height,10);if(this.options.maintainAspectRatio){let a=this.canvas.width/this.canvas.height;this.canvas.width=e,this.canvas.height=e/a}else this.canvas.width=e,this.canvas.height=s;this.draw()}setData(t){return this.data=t.map(t=>"number"==typeof t?{value:t,label:`Item ${this.data.length+1}`}:t),this}setType(t){let i=["bar","line","pie","doughnut","radar"];if(!i.includes(t))throw Error(`Invalid chart type. Valid types are: ${i.join(", ")}`);return this.chartType=t,this}setOptions(t){return this.deepMerge(this.options,t),this}animate(t,i){if(!this.options.animation.enabled){t(1);return}let e=performance.now(),s=a=>{let o=(a-e)/i;o>1&&(o=1),t(this.easing(o)),o<1&&(this.animationFrame=requestAnimationFrame(s))};this.animationFrame=requestAnimationFrame(s)}easing(t){return 1-Math.pow(1-t,4)}draw(){switch(this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.clearCanvas(),this.drawBackground(),this.options.title.display&&this.drawTitle(),this.chartType){case"bar":this.drawBarChart();break;case"line":this.drawLineChart();break;case"pie":this.drawPieChart();break;case"doughnut":this.drawDoughnutChart();break;case"radar":this.drawRadarChart()}this.options.legend.display&&this.drawLegend()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawBackground(){if(this.ctx.fillStyle=this.options.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),"transparent"!==this.options.chartArea.backgroundColor){let{left:t,top:i,right:e,bottom:s}=this.options.chartArea.padding;this.ctx.fillStyle=this.options.chartArea.backgroundColor,this.ctx.fillRect(t,i,this.canvas.width-t-e,this.canvas.height-i-s)}}drawTitle(){let{text:t,font:i,color:e,padding:s,align:a}=this.options.title;this.ctx.font=i,this.ctx.fillStyle=e,this.ctx.textAlign=a,this.ctx.textBaseline="top";let o;switch(a){case"left":o=this.options.chartArea.padding.left;break;case"right":o=this.canvas.width-this.options.chartArea.padding.right;break;default:o=this.canvas.width/2}this.ctx.fillText(t,o,s)}drawBarChart(){let{padding:t}=this.options.chartArea,i=this.canvas.width-t.left-t.right,e=this.canvas.height-t.top-t.bottom,s=Math.max(...this.data.map(t=>t.value)),a=i/this.data.length*(1-this.options.bar.columnSpacing);this.drawAxes(i,e,s),this.animate(o=>{this.data.forEach((h,n)=>{let r=t.left+n*i/this.data.length+(i/this.data.length-a)/2,l=h.value/s*e*o,c=this.canvas.height-t.bottom-l;this.ctx.beginPath(),this.options.bar.borderRadius>0?this.roundRect(r,c,a,l,this.options.bar.borderRadius):this.ctx.rect(r,c,a,l),this.ctx.fillStyle=h.color||this.options.colors[n%this.options.colors.length],this.ctx.fill(),this.options.bar.borderWidth>0&&(this.ctx.strokeStyle=this.darkenColor(this.ctx.fillStyle,.2),this.ctx.lineWidth=this.options.bar.borderWidth,this.ctx.stroke()),this.options.dataLabels.display&&this.drawDataLabel(h.value,r+a/2,c-5)})},this.options.animation.duration)}drawLineChart(){let{padding:t}=this.options.chartArea,i=this.canvas.width-t.left-t.right,e=this.canvas.height-t.top-t.bottom,s=Math.max(...this.data.map(t=>t.value));this.drawAxes(i,e,s),this.animate(a=>{this.ctx.beginPath(),this.data.forEach((o,h)=>{let n=t.left+h*i/(this.data.length-1),r=this.canvas.height-t.bottom-o.value/s*e*a;if(0===h)this.ctx.moveTo(n,r);else if(this.options.line.tension>0){let l=n-i/(this.data.length-1)/2,c=this.canvas.height-t.bottom-this.data[h-1].value/s*e*a,d=n-i/(this.data.length-1)/2;this.ctx.bezierCurveTo(l,c,d,r,n,r)}else this.ctx.lineTo(n,r)}),this.ctx.strokeStyle=this.options.colors[0],this.ctx.lineWidth=2,this.ctx.stroke(),this.options.line.fill&&(this.ctx.lineTo(t.left+i,this.canvas.height-t.bottom),this.ctx.lineTo(t.left,this.canvas.height-t.bottom),this.ctx.fillStyle=this.hexToRGBA(this.options.colors[0],.2),this.ctx.fill()),this.data.forEach((o,h)=>{let n=t.left+h*i/(this.data.length-1),r=this.canvas.height-t.bottom-o.value/s*e*a;this.drawPoint(n,r,o.color||this.options.colors[0]),this.options.dataLabels.display&&this.drawDataLabel(o.value,n,r-15)})},this.options.animation.duration)}drawPieChart(){let t=this.canvas.width/2,i=this.canvas.height/2,e=.8*Math.min(t,i),s=this.data.reduce((t,i)=>t+i.value,0),a=this.options.pie.rotation*Math.PI/180;this.animate(o=>{this.data.forEach((h,n)=>{let r=h.value/s*(this.options.pie.circumference*Math.PI/180)*o;this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.arc(t,i,e,a,a+r),this.ctx.closePath();let l=h.color||this.options.colors[n%this.options.colors.length];if(this.ctx.fillStyle=l,this.ctx.fill(),this.options.pie.borderWidth>0&&(this.ctx.strokeStyle=this.darkenColor(l,.2),this.ctx.lineWidth=this.options.pie.borderWidth,this.ctx.stroke()),this.options.dataLabels.display){let c=a+r/2,d=.7*e;this.drawDataLabel(`${(h.value/s*100).toFixed(1)}%`,t+Math.cos(c)*d,i+Math.sin(c)*d,c)}a+=r})},this.options.animation.duration)}drawDoughnutChart(){let t=this.canvas.width/2,i=this.canvas.height/2,e=.8*Math.min(t,i),s=e*(this.options.doughnut.cutoutPercentage/100),a=this.data.reduce((t,i)=>t+i.value,0),o=this.options.doughnut.rotation*Math.PI/180;this.animate(h=>{this.data.forEach((n,r)=>{let l=n.value/a*(this.options.doughnut.circumference*Math.PI/180)*h;this.ctx.beginPath(),this.ctx.arc(t,i,e,o,o+l),this.ctx.arc(t,i,s,o+l,o,!0),this.ctx.closePath();let c=n.color||this.options.colors[r%this.options.colors.length];if(this.ctx.fillStyle=c,this.ctx.fill(),this.options.doughnut.borderWidth>0&&(this.ctx.strokeStyle=this.darkenColor(c,.2),this.ctx.lineWidth=this.options.doughnut.borderWidth,this.ctx.stroke()),this.options.dataLabels.display){let d=o+l/2,p=(e+s)/2;this.drawDataLabel(`${(n.value/a*100).toFixed(1)}%`,t+Math.cos(d)*p,i+Math.sin(d)*p,d)}o+=l})},this.options.animation.duration)}drawRadarChart(){let t=this.canvas.width/2,i=this.canvas.height/2,e=.7*Math.min(t,i),s=2*Math.PI/this.data.length,a=Math.max(...this.data.map(t=>t.value));this.drawRadarGrid(t,i,e,s),this.animate(o=>{this.ctx.beginPath(),this.data.forEach((h,n)=>{let r=h.value/a*e*o,l=n*s-Math.PI/2,c=t+Math.cos(l)*r,d=i+Math.sin(l)*r;0===n?this.ctx.moveTo(c,d):this.ctx.lineTo(c,d)}),this.ctx.closePath(),this.ctx.fillStyle=this.options.radar.polygonStyle.backgroundColor,this.ctx.fill(),this.ctx.strokeStyle=this.options.radar.polygonStyle.borderColor,this.ctx.lineWidth=this.options.radar.polygonStyle.borderWidth,this.ctx.stroke(),this.data.forEach((h,n)=>{let r=h.value/a*e*o,l=n*s-Math.PI/2;this.drawPoint(t+Math.cos(l)*r,i+Math.sin(l)*r,this.options.radar.polygonStyle.borderColor),this.options.dataLabels.display&&this.drawDataLabel(h.label,t+Math.cos(l)*(e+20),i+Math.sin(l)*(e+20))})},this.options.animation.duration)}drawAxes(t,i,e){let{padding:s}=this.options.chartArea;if(this.options.scales.y.display){this.ctx.beginPath(),this.ctx.moveTo(s.left,s.top),this.ctx.lineTo(s.left,this.canvas.height-s.bottom),this.ctx.strokeStyle=this.options.scales.y.grid.color,this.ctx.stroke();let a=i/5,o=e/5;for(let h=0;h<=5;h++){let n=this.canvas.height-s.bottom-a*h,r=o*h;this.options.scales.y.grid.display&&h>0&&(this.ctx.beginPath(),this.ctx.moveTo(s.left,n),this.ctx.lineTo(this.canvas.width-s.right,n),this.ctx.strokeStyle=this.options.scales.y.grid.color,this.ctx.stroke()),this.ctx.font=this.options.scales.y.ticks.font,this.ctx.fillStyle=this.options.scales.y.ticks.color,this.ctx.textAlign="right",this.ctx.textBaseline="middle",this.ctx.fillText(this.options.scales.y.ticks.callback(r),s.left-10,n)}}this.options.scales.x.display&&(this.ctx.beginPath(),this.ctx.moveTo(s.left,this.canvas.height-s.bottom),this.ctx.lineTo(this.canvas.width-s.right,this.canvas.height-s.bottom),this.ctx.strokeStyle=this.options.scales.x.grid.color,this.ctx.stroke(),this.data.forEach((i,e)=>{let a=s.left+e*t/("line"===this.chartType?this.data.length-1:this.data.length);this.ctx.font=this.options.scales.x.ticks.font,this.ctx.fillStyle=this.options.scales.x.ticks.color,this.ctx.textAlign="center",this.ctx.textBaseline="top";let o=i.label||`Item ${e+1}`;this.options.scales.x.ticks.maxRotation>0?(this.ctx.save(),this.ctx.translate(a,this.canvas.height-s.bottom+10),this.ctx.rotate(-this.options.scales.x.ticks.maxRotation*Math.PI/180),this.ctx.fillText(o,0,0),this.ctx.restore()):this.ctx.fillText(o,a,this.canvas.height-s.bottom+10)}))}drawRadarGrid(t,i,e,s){for(let a=1;a<=5;a++){let o=e/5*a;this.ctx.beginPath(),this.ctx.arc(t,i,o,0,2*Math.PI),this.ctx.strokeStyle=this.options.radar.angleLines.color,this.ctx.lineWidth=this.options.radar.angleLines.lineWidth,this.ctx.stroke()}this.data.forEach((a,o)=>{let h=o*s-Math.PI/2;this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.lineTo(t+Math.cos(h)*e,i+Math.sin(h)*e),this.ctx.strokeStyle=this.options.radar.angleLines.color,this.ctx.lineWidth=this.options.radar.angleLines.lineWidth,this.ctx.stroke()})}drawPoint(t,i,e){let{pointStyle:s,pointRadius:a,pointBorderWidth:o}=this.options.line;switch(this.ctx.beginPath(),s){case"circle":this.ctx.arc(t,i,a,0,2*Math.PI);break;case"triangle":let h=2*Math.PI/3;for(let n=0;n<3;n++){let r=t+Math.cos(n*h)*a,l=i+Math.sin(n*h)*a;0===n?this.ctx.moveTo(r,l):this.ctx.lineTo(r,l)}this.ctx.closePath();break;case"square":this.ctx.rect(t-a,i-a,2*a,2*a)}this.ctx.fillStyle=e,this.ctx.fill(),o>0&&(this.ctx.strokeStyle=this.darkenColor(e,.2),this.ctx.lineWidth=o,this.ctx.stroke())}drawDataLabel(t,i,e,s=0){let{font:a,color:o,padding:h}=this.options.dataLabels;this.ctx.save(),this.ctx.translate(i,e),this.ctx.rotate(s),this.ctx.font=a,this.ctx.fillStyle=o,this.ctx.textAlign="center",this.ctx.textBaseline="middle";let n=this.options.dataLabels.formatter(t),r=this.ctx.measureText(n);this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillRect(-r.width/2-h,-r.actualBoundingBoxAscent/2-h,r.width+2*h,r.actualBoundingBoxAscent+2*h),this.ctx.fillStyle=o,this.ctx.fillText(n,0,0),this.ctx.restore()}drawLegend(){let{position:t,align:i,labels:e}=this.options.legend,s=this.data.map((t,i)=>({label:t.label||`Series ${i+1}`,color:t.color||this.options.colors[i%this.options.colors.length]}));this.ctx.font=e.font;let a=parseInt(e.font)+e.padding,o=Math.max(...s.map(t=>this.ctx.measureText(t.label).width)),h=e.boxWidth+e.padding+o,n=s.length*a,r,l;switch(t){case"top":case"bottom":switch(i){case"start":r=this.options.chartArea.padding.left;break;case"end":r=this.canvas.width-h-this.options.chartArea.padding.right;break;default:r=(this.canvas.width-h)/2}l="top"===t?this.options.chartArea.padding.top:this.canvas.height-n-this.options.chartArea.padding.bottom;break;case"left":case"right":r="left"===t?this.options.chartArea.padding.left:this.canvas.width-h-this.options.chartArea.padding.right,l=(this.canvas.height-n)/2}s.forEach((t,i)=>{let s=l+i*a;e.usePointStyle?this.drawPoint(r+e.boxWidth/2,s+a/2,t.color):(this.ctx.fillStyle=t.color,this.ctx.fillRect(r,s,e.boxWidth,e.boxWidth)),this.ctx.font=e.font,this.ctx.fillStyle=e.color,this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.fillText(t.label,r+e.boxWidth+e.padding,s)})}roundRect(t,i,e,s,a){e<2*a&&(a=e/2),s<2*a&&(a=s/2),this.ctx.beginPath(),this.ctx.moveTo(t+a,i),this.ctx.arcTo(t+e,i,t+e,i+s,a),this.ctx.arcTo(t+e,i+s,t,i+s,a),this.ctx.arcTo(t,i+s,t,i,a),this.ctx.arcTo(t,i,t+e,i,a),this.ctx.closePath()}darkenColor(t,i){let e=t.replace("#",""),s=parseInt(e,16);return`#${(Math.max(0,(s>>8&255)*(1-i))|Math.max(0,(255&s)*(1-i))<<8|Math.max(0,(s>>16)*(1-i))<<16).toString(16).padStart(6,"0")}`}hexToRGBA(t,i){let e=parseInt(t.slice(1,3),16),s=parseInt(t.slice(3,5),16),a=parseInt(t.slice(5,7),16);return`rgba(${e}, ${s}, ${a}, ${i})`}}function createBarChart(t,i,e={}){let s=new ChartLib(t,e);return s.setType("bar").setData(i).draw()}function createLineChart(t,i,e={}){let s=new ChartLib(t,e);return s.setType("line").setData(i).draw()}function createPieChart(t,i,e={}){let s=new ChartLib(t,e);return s.setType("pie").setData(i).draw()}function createDoughnutChart(t,i,e={}){let s=new ChartLib(t,e);return s.setType("doughnut").setData(i).draw()}function createRadarChart(t,i,e={}){let s=new ChartLib(t,e);return s.setType("radar").setData(i).draw()}"undefined"!=typeof module&&module.exports?module.exports={ChartLib,createBarChart,createLineChart,createPieChart,createDoughnutChart,createRadarChart}:(window.ChartLib=ChartLib,window.createBarChart=createBarChart,window.createLineChart=createLineChart,window.createPieChart=createPieChart,window.createDoughnutChart=createDoughnutChart,window.createRadarChart=createRadarChart);
